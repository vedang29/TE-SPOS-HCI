#include <iostream>
#include <queue>
using namespace std;

struct Process 
{
    int id, arrival, burst, remaining, completion, waiting, turnaround, response;
} p[20];

int main() 
{
    int n, tq;
    cout << "No. of processes: "; cin >> n;

    for(int i = 0; i < n; i++)
    {
        cout << "Arrival & Burst for P" << i << ": ";
        cin >> p[i].arrival >> p[i].burst;
        p[i].id = i;
        p[i].remaining = p[i].burst;
        p[i].response = -1;
    }

    cout << "Time Quantum: "; 
    cin >> tq;

    queue<int> q;
    bool inQueue[20] = {0};
    int time = 0, done = 0;

  
    int gantt[100], ganttStart[100], gIndex = 0;

    while(done < n)
    {
        for(int i=0;i<n;i++)
            if(!inQueue[i] && p[i].arrival <= time && p[i].remaining>0)
            { 
                q.push(i); inQueue[i]=1; 
            }

        if(q.empty())
        { 
            time++; 
            continue; 
        }

        int idx = q.front(); 
        q.pop();

        if(p[idx].response == -1)
            p[idx].response = time - p[idx].arrival;

        
        gantt[gIndex] = idx;
        ganttStart[gIndex] = time;
        gIndex++;

        if(p[idx].remaining <= tq)
        {
            time += p[idx].remaining;
            p[idx].remaining = 0;
            p[idx].completion = time;
            p[idx].turnaround = p[idx].completion - p[idx].arrival;
            p[idx].waiting = p[idx].turnaround - p[idx].burst;
            done++;
        } 
        else 
        { 
            time += tq; 
            p[idx].remaining -= tq; 
        }

        for(int i=0;i<n;i++)
            if(!inQueue[i] && p[i].arrival <= time && p[i].remaining>0)
            { 
                q.push(i); inQueue[i]=1; 
            }

        if(p[idx].remaining>0) 
            q.push(idx);
    }

    
    cout << "\nP\tAT\tBT\tCT\tTAT\tWT\tRT\n";
    double totalWT=0, totalTAT=0;
    for(int i=0;i<n;i++)
    {
        cout << "P"<<i<<"\t"<<p[i].arrival<<"\t"<<p[i].burst<<"\t"<<p[i].completion<<"\t"<<p[i].turnaround<<"\t"<<p[i].waiting<<"\t"<<p[i].response<<"\n";
        totalWT += p[i].waiting; totalTAT += p[i].turnaround;
    }
    cout << "\nAvg TAT = " << totalTAT/n << "\nAvg WT = " << totalWT/n << endl;

    
    cout << "\nGantt Chart:\n";
    for(int i=0;i<gIndex;i++)
        cout << "| P" << gantt[i] << " ";
    cout << "|\n";
    for(int i=0;i<gIndex;i++)
        cout << ganttStart[i] << "\t";
    cout << time << "\n";

    return 0;
}

import tkinter as tk
from tkinter import filedialog, messagebox
from PIL import Image, ImageTk
import cv2
import pytesseract


pytesseract.pytesseract.tesseract_cmd = r"C:\Program Files\Tesseract-OCR\tesseract.exe"


class OCRApp:
    def __init__(self, root):
        self.root = root
        self.root.title("Simple OCR GUI")

        
        self.btn_load = tk.Button(root, text="Load Image", command=self.load_image)
        self.btn_load.pack(pady=10)

       
        self.image_label = tk.Label(root)
        self.image_label.pack()

        self.text_box = tk.Text(root, height=15, width=60)
        self.text_box.pack(pady=10)

    def load_image(self):
        file_path = filedialog.askopenfilename(
            title="Select Image",
            filetypes=[("Image Files", "*.png *.jpg *.jpeg *.bmp")]
        )

        if not file_path:
            return

        
        image = cv2.imread(file_path)
        if image is None:
            messagebox.showerror("Error", "Failed to load image!")
            return

        
        image_rgb = cv2.cvtColor(image, cv2.COLOR_BGR2RGB)

       
        extracted_text = pytesseract.image_to_string(image_rgb)

       
        img = Image.fromarray(image_rgb)
        img.thumbnail((400, 400))  
        imgtk = ImageTk.PhotoImage(img)
        self.image_label.config(image=imgtk)
        self.image_label.image = imgtk  

        
        self.text_box.delete(1.0, tk.END)
        self.text_box.insert(tk.END, extracted_text)


if __name__ == "__main__":
    root = tk.Tk()
    app = OCRApp(root)
    root.mainloop()
